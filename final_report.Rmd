---
title: "Final Report"
output: 
  html_document:
    code_folding: hide
    toc: true
    toc_float: true
    theme: cosmo
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggplot2)
library(httr)
library(lubridate)
library(plotly)

```

### Motivation
One of our group members' had the unfortunate experience of getting her car towed last year, due to parking near by a fire hydrant in Minnesota. A news report published by New York Post about locations drivers were most likely to get a parking ticket in NYC between October 2020 and September 2021 [-Link]( https://nypost.com/2021/11/18/these-are-the-worst-nyc-streets-for-getting-a-parking-ticket/). We were intrigued by the potential of investigating the parking violation in NYC in 2021. 

(insert code)

### Questions
1. When and where a parking ticket in NYC is most likely to be found?
2. what possible factors are associated with the tickets? The driver's experience, the car's size?
3. how to avoid the future ticket? Suggestions based on the analysis...


### Data

#### Data Processing and Cleaning
We used two datasets from NYC OpenData in our project:

* Open Parking and Camera Violations 
[-Link](https://data.cityofnewyork.us/City-Government/Open-Parking-and-Camera-Violations/nc67-uf89)

The Open Parking and Camera Violations contains violations from 2016 to 2021 and have 73.6 millions of rows. Since we only focus on year 2021 from January to October, we filter the dataset on the website page to remove redundant information and download the dataset after filtering. The dataset we used was too large to store in github. We are interested in parking violation in five boroughs, Manhattan, Kings, The Bronx, State Island, and Queens. The original variable `county` renamed as `borough` and names are aligned. We separated the `issue_date` into `month`, `date`, and `year` and apply function to find the weekday of the date. We further broke down the `violation_time` into `hour` and `min` for plotting the violation over a day.


* Parking Violations Issued - Fiscal Year 2021
[-Link](https://data.cityofnewyork.us/City-Government/Parking-Violations-Issued-Fiscal-Year-2021/kvfd-bves)

The Parking Violations Issued - Fiscal Year 2021 dataset provides information about the violations issued during the respective fiscal year. We extract the information about the location where parking violation issused in 2021. The variables we count on are `House Number`, `Street Name`, `Intersecting Street`. We would combine the contents from those columns and draw the complete address where violation happened. These addresses would occur as a data point in the map for data visualization. 

After data cleaning, the two datasets are joined by `summons_number` finally.

* Hydrants in NYC
[-Link](https://data.cityofnewyork.us/Environment/NYCDEP-Citywide-Hydrants/6pui-xhxz)


#### Variable of Interests

__Open Parking and Camera Violations__

* `plate`

* `issue_date`

* `violation_time`

* `violation` : type of violation

* `fine_amount`

* `borough`

* `weekday`

__The Parking Violations Issued - Fiscal Year 2021__

The key variables that we used in our analysis include for mapping

* `House Number`

* `Street Name`

* `Intersecting Street` 


### Exploratory Analyses

**Open Parking and Camera Violations**

We use the dataset to explored about the distribution of number of of violation and violation types in five boroughs to understand the trend of violation in NYC. Then, we explored the distribution of number of violation over a day and in each weekday. 

[Violation Frequency](frequencyI.html)

[Violation Timeline](timeline-part.html)


Total fine amount and average fine amount in each county Waveley

[Fine Amount](fines.html)

#### Visualization over time
We export the complete parking violation address from the Parking Violations Issued - Fiscal Year 2021 dataset. The package of tidygeocoder makes getting data from geocoding services easy. We import the address data and get the return of latitudes and longitudes via Google Api. Dropping the null value, we obtain the csv file containing latitudes and longitudes of parking violation address. Then we adopt the file to visualize geographical data on the map in [kepler](https://kepler.gl/). The shining points reveal the parking violation sites distribution.

### Statistical Analyses
We conduct a one-way anova test about the violation frequency to see if there is significant difference between weekdays and month. In addition, we perform chi-squared test to test the homogeneity of violation types in five boroughs. Click the link see the details about [Statistical Analyses](statistical-analysis.html)

### Discussion

After conducting the exploratory analyses, we found that:

* **Brooklyn** has the highest number of tickets among five boroughs. Manhattan and Queens have approximately the same number of tickets. 

* There is a sharp increase in number of tickets in **October** in all boroughs. 

* Top three types of violation: **No Parking-Street Cleaning**, **Inspection Sticker Expired/Missing**, **Fail to Display a muni-meter receipt**.

* **Saturday** has the lowest violation counts and **Friday** had the second lowest counts comparing to all other weekdays.

* Violation increases from **6:00 AM** to **8:00 AM**, remains high in **8:00 AM** to **2:00 PM**, decrease from **2:00 PM** to **7:00 PM**.

* Average fine amount is **highest** in **Manhattan** and **lowest** in **Staten Island**. There is **significant difference** between fine amounts and at least 2 boroughs.

* **Suburban(SUBN)** is the vehicle type that has the highest number of violation.

